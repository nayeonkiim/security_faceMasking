from file import file_read
from decrypt import dec
from img_change import toImgFile

bin_filePath = "C:/opencv/5m10/14.50.24.txt"
mac = b'/u\x8b\x19\x00i&\x85\xa6\x83\x91\xe5"E\xa6\xc1'
text = file_read(bin_filePath)

key = bytes([0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF])
aad = bytes([0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E])
nonce = bytes([0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC])  # 기본 12(96bit)byte이며 길이 변경 가능.

# 복호화
result = dec(key, aad, nonce, text, mac)
print(result)
toImgFile(result, bin_filePath)